<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Water Quality Assessment • geospatialsuite</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Water Quality Assessment">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">geospatialsuite</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vegetation-indices.html">Vegetation Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/agricultural-analysis.html">Agricultural Applications</a></li>
    <li><a class="dropdown-item" href="../articles/analyze-crop-vegetation.html">Analyzing Crop Vegetation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/spatial-analysis.html">Spatial Operations</a></li>
    <li><a class="dropdown-item" href="../articles/spatial-integration.html">Spatial Integration</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/water-quality.html">Water Quality Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/workflows-case-studies.html">Complete Workflows</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cwru-sdle/geospatialsuite" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../paper.html">JOSS Paper</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Water Quality Assessment</h1>
                        <h4 data-toc-skip class="author">geospatialsuite
Development Team</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cwru-sdle/geospatialsuite/blob/main/vignettes/water-quality.Rmd" class="external-link"><code>vignettes/water-quality.Rmd</code></a></small>
      <div class="d-none name"><code>water-quality.Rmd</code></div>
    </div>

    
    
<hr>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The geospatialsuite package provides comprehensive tools for water
quality assessment using remote sensing data. This vignette demonstrates
water detection indices, quality parameter monitoring, and basic trend
analysis using the package’s reliable functions.</p>
</div>
<div class="section level2">
<h2 id="learning-objectives">Learning Objectives<a class="anchor" aria-label="anchor" href="#learning-objectives"></a>
</h2>
<p>By the end of this vignette, you will be able to:</p>
<ul>
<li>Calculate water detection indices (NDWI, MNDWI, NDMI)</li>
<li>Analyze water quality parameters from field data</li>
<li>Detect temporal changes in water conditions</li>
<li>Create water quality visualizations</li>
<li>Apply threshold-based classifications</li>
</ul>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cwru-sdle.github.io/geospatialsuite/">geospatialsuite</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check package functionality</span></span>
<span><span class="fu"><a href="../reference/test_package_minimal.html">test_package_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="water-detection-indices">Water Detection Indices<a class="anchor" aria-label="anchor" href="#water-detection-indices"></a>
</h2>
<div class="section level3">
<h3 id="basic-water-index-calculation">Basic Water Index Calculation<a class="anchor" aria-label="anchor" href="#basic-water-index-calculation"></a>
</h3>
<p>The package includes multiple water indices for different
applications:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load sample bands (Green, NIR, SWIR1)</span></span>
<span><span class="va">green_band</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>nrows <span class="op">=</span> <span class="fl">100</span>, ncols <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                   xmin <span class="op">=</span> <span class="op">-</span><span class="fl">84</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">83</span>, ymin <span class="op">=</span> <span class="fl">40</span>, ymax <span class="op">=</span> <span class="fl">41</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">green_band</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nir_band</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>nrows <span class="op">=</span> <span class="fl">100</span>, ncols <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                 xmin <span class="op">=</span> <span class="op">-</span><span class="fl">84</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">83</span>, ymin <span class="op">=</span> <span class="fl">40</span>, ymax <span class="op">=</span> <span class="fl">41</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">nir_band</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">swir1_band</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>nrows <span class="op">=</span> <span class="fl">100</span>, ncols <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                   xmin <span class="op">=</span> <span class="op">-</span><span class="fl">84</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">83</span>, ymin <span class="op">=</span> <span class="fl">40</span>, ymax <span class="op">=</span> <span class="fl">41</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">swir1_band</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate Original NDWI (McFeeters 1996) - Water body detection</span></span>
<span><span class="va">ndwi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_water_index.html">calculate_water_index</a></span><span class="op">(</span></span>
<span>  green <span class="op">=</span> <span class="va">green_band</span>,</span>
<span>  nir <span class="op">=</span> <span class="va">nir_band</span>,</span>
<span>  index_type <span class="op">=</span> <span class="st">"NDWI"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate Modified NDWI (Xu 2006) - Enhanced water detection</span></span>
<span><span class="va">mndwi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_water_index.html">calculate_water_index</a></span><span class="op">(</span></span>
<span>  green <span class="op">=</span> <span class="va">green_band</span>,</span>
<span>  nir <span class="op">=</span> <span class="va">nir_band</span>,</span>
<span>  swir1 <span class="op">=</span> <span class="va">swir1_band</span>,</span>
<span>  index_type <span class="op">=</span> <span class="st">"MNDWI"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate NDMI (Gao 1996) - Vegetation moisture content</span></span>
<span><span class="va">ndmi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_water_index.html">calculate_water_index</a></span><span class="op">(</span></span>
<span>  green <span class="op">=</span> <span class="va">green_band</span>,</span>
<span>  nir <span class="op">=</span> <span class="va">nir_band</span>,</span>
<span>  swir1 <span class="op">=</span> <span class="va">swir1_band</span>,</span>
<span>  index_type <span class="op">=</span> <span class="st">"NDMI"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="available-water-indices">Available Water Indices<a class="anchor" aria-label="anchor" href="#available-water-indices"></a>
</h3>
<p>See all available water indices and their applications:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List all available water indices</span></span>
<span><span class="va">water_indices_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/list_water_indices.html">list_water_indices</a></span><span class="op">(</span>detailed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">water_indices_info</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Index                Type Required_Bands Primary_Application</span></span>
<span><span class="co">#&gt; 1  NDWI     Water Detection     Green, NIR     water_detection</span></span>
<span><span class="co">#&gt; 2 MNDWI     Water Detection   Green, SWIR1     water_detection</span></span>
<span><span class="co">#&gt; 3  NDMI Vegetation Moisture     NIR, SWIR1 moisture_monitoring</span></span>
<span><span class="co">#&gt; 4   MSI     Moisture Stress     NIR, SWIR1  drought_assessment</span></span>
<span><span class="co">#&gt; 5  NDII Vegetation Moisture     NIR, SWIR1 moisture_monitoring</span></span>
<span><span class="co">#&gt; 6    WI       Water Content     NIR, SWIR1 moisture_monitoring</span></span>
<span><span class="co">#&gt; 7  SRWI       Water Content     NIR, SWIR1 moisture_monitoring</span></span>
<span><span class="co">#&gt; 8  LSWI       Surface Water     NIR, SWIR1     water_detection</span></span>
<span><span class="co">#&gt;                                                                           Description</span></span>
<span><span class="co">#&gt; 1 Normalized Difference Water Index (McFeeters 1996) - Original water detection index</span></span>
<span><span class="co">#&gt; 2 Modified NDWI (Xu 2006) - Enhanced water detection, reduces built-up area confusion</span></span>
<span><span class="co">#&gt; 3          Normalized Difference Moisture Index (Gao 1996) - Vegetation water content</span></span>
<span><span class="co">#&gt; 4        Moisture Stress Index - Plant water stress detection (lower = more moisture)</span></span>
<span><span class="co">#&gt; 5     Normalized Difference Infrared Index - Alternative name for vegetation moisture</span></span>
<span><span class="co">#&gt; 6                             Water Index - Simple ratio for water content assessment</span></span>
<span><span class="co">#&gt; 7                       Simple Ratio Water Index - Water content using NIR/SWIR ratio</span></span>
<span><span class="co">#&gt; 8                         Land Surface Water Index - Surface water content assessment</span></span>
<span><span class="co">#&gt;   Value_Range  Water_Threshold          Reference</span></span>
<span><span class="co">#&gt; 1     [-1, 1]            &gt; 0.3   McFeeters (1996)</span></span>
<span><span class="co">#&gt; 2     [-1, 1]            &gt; 0.5          Xu (2006)</span></span>
<span><span class="co">#&gt; 3     [-1, 1] N/A (vegetation)         Gao (1996)</span></span>
<span><span class="co">#&gt; 4    [0, 10+]            &lt; 1.0            Various</span></span>
<span><span class="co">#&gt; 5     [-1, 1] N/A (vegetation) Hunt &amp; Rock (1989)</span></span>
<span><span class="co">#&gt; 6    [0, 10+]            &gt; 1.0            Various</span></span>
<span><span class="co">#&gt; 7    [0, 10+]            &gt; 1.0            Various</span></span>
<span><span class="co">#&gt; 8     [-1, 1]            &gt; 0.0 Xiao et al. (2002)</span></span>
<span><span class="co">#&gt;                             Formula</span></span>
<span><span class="co">#&gt; 1     (Green - NIR) / (Green + NIR)</span></span>
<span><span class="co">#&gt; 2 (Green - SWIR1) / (Green + SWIR1)</span></span>
<span><span class="co">#&gt; 3     (NIR - SWIR1) / (NIR + SWIR1)</span></span>
<span><span class="co">#&gt; 4                       SWIR1 / NIR</span></span>
<span><span class="co">#&gt; 5     (NIR - SWIR1) / (NIR + SWIR1)</span></span>
<span><span class="co">#&gt; 6                       NIR / SWIR1</span></span>
<span><span class="co">#&gt; 7                       NIR / SWIR1</span></span>
<span><span class="co">#&gt; 8     (NIR - SWIR1) / (NIR + SWIR1)</span></span>
<span><span class="co">#&gt;                                      Satellite_Bands</span></span>
<span><span class="co">#&gt; 1  Landsat: B3,B5 | Sentinel-2: B3,B8 | MODIS: B4,B2</span></span>
<span><span class="co">#&gt; 2 Landsat: B3,B6 | Sentinel-2: B3,B11 | MODIS: B4,B6</span></span>
<span><span class="co">#&gt; 3 Landsat: B5,B6 | Sentinel-2: B8,B11 | MODIS: B2,B6</span></span>
<span><span class="co">#&gt; 4 Landsat: B5,B6 | Sentinel-2: B8,B11 | MODIS: B2,B6</span></span>
<span><span class="co">#&gt; 5 Landsat: B5,B6 | Sentinel-2: B8,B11 | MODIS: B2,B6</span></span>
<span><span class="co">#&gt; 6 Landsat: B5,B6 | Sentinel-2: B8,B11 | MODIS: B2,B6</span></span>
<span><span class="co">#&gt; 7 Landsat: B5,B6 | Sentinel-2: B8,B11 | MODIS: B2,B6</span></span>
<span><span class="co">#&gt; 8 Landsat: B5,B6 | Sentinel-2: B8,B11 | MODIS: B2,B6</span></span>
<span><span class="co">#&gt;                                                                            Interpretation</span></span>
<span><span class="co">#&gt; 1       Water bodies: &gt;0.3, Vegetation: &lt;0, Built-up: 0-0.2. Sensitive to built-up areas.</span></span>
<span><span class="co">#&gt; 2       Water bodies: &gt;0.5, Vegetation: &lt;0, Built-up: &lt;0.3. Better urban water detection.</span></span>
<span><span class="co">#&gt; 3        High moisture: &gt;0.4, Moderate: 0.1-0.4, Low: &lt;0.1. For vegetation water content.</span></span>
<span><span class="co">#&gt; 4     High moisture: &lt;1.0, Moderate: 1.0-1.6, Stress: &gt;1.6. Lower values = more moisture.</span></span>
<span><span class="co">#&gt; 5                  Same as NDMI. High values indicate higher vegetation moisture content.</span></span>
<span><span class="co">#&gt; 6 Higher values generally indicate higher water content. Threshold varies by application.</span></span>
<span><span class="co">#&gt; 7                                Similar to WI. Used for simple water content assessment.</span></span>
<span><span class="co">#&gt; 8  Higher values indicate more surface water. Used for wetland and irrigation monitoring.</span></span>
<span></span>
<span><span class="co"># Get indices for specific applications</span></span>
<span><span class="va">water_detection</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/list_water_indices.html">list_water_indices</a></span><span class="op">(</span>application_filter <span class="op">=</span> <span class="st">"water_detection"</span><span class="op">)</span></span>
<span><span class="va">moisture_monitoring</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/list_water_indices.html">list_water_indices</a></span><span class="op">(</span>application_filter <span class="op">=</span> <span class="st">"moisture_monitoring"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multiple-water-index-calculation">Multiple Water Index Calculation<a class="anchor" aria-label="anchor" href="#multiple-water-index-calculation"></a>
</h3>
<p>Calculate multiple indices simultaneously for comprehensive
analysis:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate multiple water indices at once</span></span>
<span><span class="va">water_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_multiple_water_indices.html">calculate_multiple_water_indices</a></span><span class="op">(</span></span>
<span>  green <span class="op">=</span> <span class="va">green_band</span>,</span>
<span>  nir <span class="op">=</span> <span class="va">nir_band</span>,</span>
<span>  swir1 <span class="op">=</span> <span class="va">swir1_band</span>,</span>
<span>  indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NDWI"</span>, <span class="st">"MNDWI"</span>, <span class="st">"NDMI"</span>, <span class="st">"MSI"</span><span class="op">)</span>,</span>
<span>  output_stack <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access individual indices</span></span>
<span><span class="va">ndwi_layer</span> <span class="op">&lt;-</span> <span class="va">water_analysis</span><span class="op">[[</span><span class="st">"NDWI"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">mndwi_layer</span> <span class="op">&lt;-</span> <span class="va">water_analysis</span><span class="op">[[</span><span class="st">"MNDWI"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="water-body-analysis">Water Body Analysis<a class="anchor" aria-label="anchor" href="#water-body-analysis"></a>
</h2>
<div class="section level3">
<h3 id="comprehensive-water-body-characterization">Comprehensive Water Body Characterization<a class="anchor" aria-label="anchor" href="#comprehensive-water-body-characterization"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform complete water body analysis</span></span>
<span><span class="va">water_body_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_water_bodies.html">analyze_water_bodies</a></span><span class="op">(</span></span>
<span>  green <span class="op">=</span> <span class="va">green_band</span>,</span>
<span>  nir <span class="op">=</span> <span class="va">nir_band</span>,</span>
<span>  swir1 <span class="op">=</span> <span class="va">swir1_band</span>,</span>
<span>  water_threshold_ndwi <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  water_threshold_mndwi <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access results</span></span>
<span><span class="va">water_indices</span> <span class="op">&lt;-</span> <span class="va">water_body_analysis</span><span class="op">$</span><span class="va">water_indices</span></span>
<span><span class="va">water_masks</span> <span class="op">&lt;-</span> <span class="va">water_body_analysis</span><span class="op">$</span><span class="va">water_masks</span></span>
<span><span class="va">statistics</span> <span class="op">&lt;-</span> <span class="va">water_body_analysis</span><span class="op">$</span><span class="va">statistics</span></span>
<span></span>
<span><span class="co"># Print water body statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">statistics</span><span class="op">)</span></span>
<span><span class="co">#&gt; $ndwi_water</span></span>
<span><span class="co">#&gt; $ndwi_water$water_pixels</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ndwi_water$total_pixels</span></span>
<span><span class="co">#&gt; [1] 10000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ndwi_water$water_percentage</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ndwi_water$pixel_area_m2</span></span>
<span><span class="co">#&gt; [1] 1e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ndwi_water$estimated_water_area_m2</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mndwi_water</span></span>
<span><span class="co">#&gt; $mndwi_water$water_pixels</span></span>
<span><span class="co">#&gt; [1] 440</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mndwi_water$total_pixels</span></span>
<span><span class="co">#&gt; [1] 10000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mndwi_water$water_percentage</span></span>
<span><span class="co">#&gt; [1] 4.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mndwi_water$pixel_area_m2</span></span>
<span><span class="co">#&gt; [1] 1e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mndwi_water$estimated_water_area_m2</span></span>
<span><span class="co">#&gt; [1] 0.044</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $consensus</span></span>
<span><span class="co">#&gt; $consensus$water_pixels</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $consensus$total_pixels</span></span>
<span><span class="co">#&gt; [1] 10000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $consensus$water_percentage</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $consensus$pixel_area_m2</span></span>
<span><span class="co">#&gt; [1] 1e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $consensus$estimated_water_area_m2</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="field-water-quality-data-analysis">Field Water Quality Data Analysis<a class="anchor" aria-label="anchor" href="#field-water-quality-data-analysis"></a>
</h2>
<div class="section level3">
<h3 id="loading-and-processing-water-quality-data">Loading and Processing Water Quality Data<a class="anchor" aria-label="anchor" href="#loading-and-processing-water-quality-data"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create sample water quality monitoring data</span></span>
<span><span class="va">sample_water_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  station_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"WQ_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span>,</span>
<span>  longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="op">-</span><span class="fl">84</span>, <span class="op">-</span><span class="fl">83</span><span class="op">)</span>,</span>
<span>  latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">40</span>, <span class="fl">41</span><span class="op">)</span>,</span>
<span>  temperature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">15</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>  ph <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">6.5</span>, <span class="fl">8.5</span><span class="op">)</span>,</span>
<span>  dissolved_oxygen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">5</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  turbidity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">2</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>  nitrate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0.5</span>, <span class="fl">5.0</span><span class="op">)</span>,</span>
<span>  phosphorus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0.1</span>, <span class="fl">2.0</span><span class="op">)</span>,</span>
<span>  sample_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2023-06-01"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">180</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Comprehensive water quality analysis</span></span>
<span><span class="va">water_quality_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_water_quality_comprehensive.html">analyze_water_quality_comprehensive</a></span><span class="op">(</span></span>
<span>  water_data <span class="op">=</span> <span class="va">sample_water_data</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"dissolved_oxygen"</span>,</span>
<span>  coord_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>,</span>
<span>  thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Excellent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>    Good <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>    Fair <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    Poor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access analysis results</span></span>
<span><span class="va">quality_stats</span> <span class="op">&lt;-</span> <span class="va">water_quality_results</span><span class="op">$</span><span class="va">statistics</span></span>
<span><span class="va">spatial_patterns</span> <span class="op">&lt;-</span> <span class="va">water_quality_results</span><span class="op">$</span><span class="va">spatial_analysis</span></span>
<span><span class="va">temporal_trends</span> <span class="op">&lt;-</span> <span class="va">water_quality_results</span><span class="op">$</span><span class="va">temporal_analysis</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multi-parameter-analysis">Multi-Parameter Analysis<a class="anchor" aria-label="anchor" href="#multi-parameter-analysis"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analyze multiple water quality parameters</span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature"</span>, <span class="st">"ph"</span>, <span class="st">"dissolved_oxygen"</span>, <span class="st">"turbidity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multi_param_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">param</span> <span class="kw">in</span> <span class="va">parameters</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">multi_param_results</span><span class="op">[[</span><span class="va">param</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_water_quality_comprehensive.html">analyze_water_quality_comprehensive</a></span><span class="op">(</span></span>
<span>    water_data <span class="op">=</span> <span class="va">sample_water_data</span>,</span>
<span>    variable <span class="op">=</span> <span class="va">param</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Extract key statistics</span></span>
<span><span class="va">param_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">parameters</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">stats</span> <span class="op">&lt;-</span> <span class="va">multi_param_results</span><span class="op">[[</span><span class="va">p</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">statistics</span><span class="op">$</span><span class="va">primary_variable</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">stats</span><span class="op">$</span><span class="va">mean</span>, sd <span class="op">=</span> <span class="va">stats</span><span class="op">$</span><span class="va">sd</span>, min <span class="op">=</span> <span class="va">stats</span><span class="op">$</span><span class="va">min</span>, max <span class="op">=</span> <span class="va">stats</span><span class="op">$</span><span class="va">max</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">param_summary</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<div class="section level3">
<h3 id="water-index-visualization">Water Index Visualization<a class="anchor" aria-label="anchor" href="#water-index-visualization"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Quick water index mapping</span></span>
<span><span class="fu"><a href="../reference/quick_map.html">quick_map</a></span><span class="op">(</span><span class="va">ndwi</span>, title <span class="op">=</span> <span class="st">"NDWI - Water Detection"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/quick_map.html">quick_map</a></span><span class="op">(</span><span class="va">mndwi</span>, title <span class="op">=</span> <span class="st">"MNDWI - Enhanced Water Detection"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create water quality map with region boundary</span></span>
<span><span class="va">water_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_spatial_map.html">create_spatial_map</a></span><span class="op">(</span></span>
<span>  spatial_data <span class="op">=</span> <span class="va">water_quality_results</span><span class="op">$</span><span class="va">water_data</span>,</span>
<span>  fill_variable <span class="op">=</span> <span class="st">"dissolved_oxygen"</span>,</span>
<span>  region_boundary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">84</span>, <span class="fl">40</span>, <span class="op">-</span><span class="fl">83</span>, <span class="fl">41</span><span class="op">)</span>,  <span class="co"># Custom bounding box</span></span>
<span>  color_scheme <span class="op">=</span> <span class="st">"water"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Dissolved Oxygen Concentrations"</span>,</span>
<span>  point_size <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparison-maps">Comparison Maps<a class="anchor" aria-label="anchor" href="#comparison-maps"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare different water indices</span></span>
<span><span class="va">comparison_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_comparison_map.html">create_comparison_map</a></span><span class="op">(</span></span>
<span>  data1 <span class="op">=</span> <span class="va">ndwi</span>,</span>
<span>  data2 <span class="op">=</span> <span class="va">mndwi</span>,</span>
<span>  comparison_type <span class="op">=</span> <span class="st">"side_by_side"</span>,</span>
<span>  titles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NDWI (Original)"</span>, <span class="st">"MNDWI (Modified)"</span><span class="op">)</span>,</span>
<span>  color_scheme <span class="op">=</span> <span class="st">"water"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="threshold-analysis">Threshold Analysis<a class="anchor" aria-label="anchor" href="#threshold-analysis"></a>
</h2>
<div class="section level3">
<h3 id="water-quality-classification">Water Quality Classification<a class="anchor" aria-label="anchor" href="#water-quality-classification"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply water quality standards</span></span>
<span><span class="va">quality_thresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  Excellent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>  Good <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>  Moderate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>  Poor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  Very_Poor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Classify water quality</span></span>
<span><span class="va">classified_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_water_quality_comprehensive.html">analyze_water_quality_comprehensive</a></span><span class="op">(</span></span>
<span>  water_data <span class="op">=</span> <span class="va">sample_water_data</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"dissolved_oxygen"</span>,</span>
<span>  thresholds <span class="op">=</span> <span class="va">quality_thresholds</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View classification results</span></span>
<span><span class="va">threshold_stats</span> <span class="op">&lt;-</span> <span class="va">classified_results</span><span class="op">$</span><span class="va">threshold_analysis</span><span class="op">$</span><span class="va">threshold_statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">threshold_stats</span><span class="op">$</span><span class="va">category_percentages</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="water-body-detection-thresholds">Water Body Detection Thresholds<a class="anchor" aria-label="anchor" href="#water-body-detection-thresholds"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply standard water detection thresholds</span></span>
<span><span class="va">water_pixels_ndwi</span> <span class="op">&lt;-</span> <span class="va">ndwi</span> <span class="op">&gt;</span> <span class="fl">0.3</span>   <span class="co"># Standard NDWI threshold</span></span>
<span><span class="va">water_pixels_mndwi</span> <span class="op">&lt;-</span> <span class="va">mndwi</span> <span class="op">&gt;</span> <span class="fl">0.5</span>  <span class="co"># Standard MNDWI threshold</span></span>
<span></span>
<span><span class="co"># Combine for consensus water mask</span></span>
<span><span class="va">consensus_water</span> <span class="op">&lt;-</span> <span class="va">water_pixels_ndwi</span> <span class="op">&amp;</span> <span class="va">water_pixels_mndwi</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">consensus_water</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"consensus_water_mask"</span></span>
<span></span>
<span><span class="co"># Visualize water detection</span></span>
<span><span class="fu"><a href="../reference/quick_map.html">quick_map</a></span><span class="op">(</span><span class="va">consensus_water</span>, title <span class="op">=</span> <span class="st">"Consensus Water Detection"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="temporal-analysis">Temporal Analysis<a class="anchor" aria-label="anchor" href="#temporal-analysis"></a>
</h2>
<div class="section level3">
<h3 id="time-series-water-quality-monitoring">Time Series Water Quality Monitoring<a class="anchor" aria-label="anchor" href="#time-series-water-quality-monitoring"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create temporal water quality data</span></span>
<span><span class="va">temporal_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  station_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"WQ_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>  longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">84</span>, <span class="op">-</span><span class="fl">83</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>  latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">40</span>, <span class="fl">41</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>  month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  dissolved_oxygen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">4</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  temperature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">5</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>  sample_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>, </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2023-12-01"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyze temporal patterns</span></span>
<span><span class="va">temporal_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_water_quality_comprehensive.html">analyze_water_quality_comprehensive</a></span><span class="op">(</span></span>
<span>  water_data <span class="op">=</span> <span class="va">temporal_data</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"dissolved_oxygen"</span>,</span>
<span>  date_column <span class="op">=</span> <span class="st">"sample_date"</span>,</span>
<span>  station_id_col <span class="op">=</span> <span class="st">"station_id"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check for temporal trends</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">temporal_results</span><span class="op">$</span><span class="va">temporal_analysis</span><span class="op">$</span><span class="va">trend</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">trend_info</span> <span class="op">&lt;-</span> <span class="va">temporal_results</span><span class="op">$</span><span class="va">temporal_analysis</span><span class="op">$</span><span class="va">trend</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Temporal trend slope:"</span>, <span class="va">trend_info</span><span class="op">$</span><span class="va">slope</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Significance (p-value):"</span>, <span class="va">trend_info</span><span class="op">$</span><span class="va">p_value</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"R-squared:"</span>, <span class="va">trend_info</span><span class="op">$</span><span class="va">r_squared</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="real-world-applications">Real-World Applications<a class="anchor" aria-label="anchor" href="#real-world-applications"></a>
</h2>
<div class="section level3">
<h3 id="lake-water-quality-assessment">Lake Water Quality Assessment<a class="anchor" aria-label="anchor" href="#lake-water-quality-assessment"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate lake monitoring scenario</span></span>
<span><span class="va">lake_stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  station <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Lake_"</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span>, <span class="op">-</span><span class="fl">83.5</span>, <span class="op">-</span><span class="fl">83.0</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40.2</span>, <span class="fl">40.7</span><span class="op">)</span>,</span>
<span>  depth_m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">1</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>  temp_celsius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">18</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>  ph <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">7.0</span>, <span class="fl">8.5</span><span class="op">)</span>,</span>
<span>  do_mg_l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">6</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>  chlorophyll_ug_l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">5</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>  secchi_depth_m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Comprehensive lake analysis</span></span>
<span><span class="va">lake_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_water_quality_comprehensive.html">analyze_water_quality_comprehensive</a></span><span class="op">(</span></span>
<span>  water_data <span class="op">=</span> <span class="va">lake_stations</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"do_mg_l"</span>,</span>
<span>  coord_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span>,</span>
<span>  thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Hypoxic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    Low <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>    Adequate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>    High <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="cn">Inf</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyze chlorophyll patterns</span></span>
<span><span class="va">chlorophyll_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_water_quality_comprehensive.html">analyze_water_quality_comprehensive</a></span><span class="op">(</span></span>
<span>  water_data <span class="op">=</span> <span class="va">lake_stations</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"chlorophyll_ug_l"</span>,</span>
<span>  thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Oligotrophic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>    Mesotrophic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    Eutrophic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="cn">Inf</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="stream-network-integration">Stream Network Integration<a class="anchor" aria-label="anchor" href="#stream-network-integration"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analyze water quality along stream network</span></span>
<span><span class="va">stream_monitoring</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  site_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Stream_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>,</span>
<span>  longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span>, <span class="op">-</span><span class="fl">83.8</span>, <span class="op">-</span><span class="fl">83.2</span><span class="op">)</span>,</span>
<span>  latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">40.1</span>, <span class="fl">40.8</span><span class="op">)</span>,</span>
<span>  stream_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">30</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  flow_cms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">0.1</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  water_temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">12</span>, <span class="fl">22</span><span class="op">)</span>,</span>
<span>  conductivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">200</span>, <span class="fl">800</span><span class="op">)</span>,</span>
<span>  total_nitrogen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">0.5</span>, <span class="fl">8.0</span><span class="op">)</span>,</span>
<span>  total_phosphorus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">0.05</span>, <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyze nutrient patterns</span></span>
<span><span class="va">nitrogen_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_water_quality_comprehensive.html">analyze_water_quality_comprehensive</a></span><span class="op">(</span></span>
<span>  water_data <span class="op">=</span> <span class="va">stream_monitoring</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"total_nitrogen"</span>,</span>
<span>  thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Low <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    Moderate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>    High <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="cn">Inf</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">phosphorus_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_water_quality_comprehensive.html">analyze_water_quality_comprehensive</a></span><span class="op">(</span></span>
<span>  water_data <span class="op">=</span> <span class="va">stream_monitoring</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"total_phosphorus"</span>,</span>
<span>  thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Low <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>    Moderate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>    High <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="cn">Inf</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="error-handling-and-troubleshooting">Error Handling and Troubleshooting<a class="anchor" aria-label="anchor" href="#error-handling-and-troubleshooting"></a>
</h2>
<div class="section level3">
<h3 id="common-issues-and-solutions">Common Issues and Solutions<a class="anchor" aria-label="anchor" href="#common-issues-and-solutions"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Handle missing coordinate data</span></span>
<span><span class="va">incomplete_data</span> <span class="op">&lt;-</span> <span class="va">sample_water_data</span></span>
<span><span class="va">incomplete_data</span><span class="op">$</span><span class="va">latitude</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># The function automatically handles missing coordinates</span></span>
<span><span class="va">robust_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_water_quality_comprehensive.html">analyze_water_quality_comprehensive</a></span><span class="op">(</span></span>
<span>  water_data <span class="op">=</span> <span class="va">incomplete_data</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"dissolved_oxygen"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Handle different coordinate column names</span></span>
<span><span class="va">alt_coord_data</span> <span class="op">&lt;-</span> <span class="va">sample_water_data</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">alt_coord_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">alt_coord_data</span><span class="op">)</span> <span class="op">==</span> <span class="st">"longitude"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"x"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">alt_coord_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">alt_coord_data</span><span class="op">)</span> <span class="op">==</span> <span class="st">"latitude"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Function auto-detects coordinate columns</span></span>
<span><span class="va">auto_detect_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_water_quality_comprehensive.html">analyze_water_quality_comprehensive</a></span><span class="op">(</span></span>
<span>  water_data <span class="op">=</span> <span class="va">alt_coord_data</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"ph"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-quality-checks">Data Quality Checks<a class="anchor" aria-label="anchor" href="#data-quality-checks"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply quality filters during analysis</span></span>
<span><span class="va">filtered_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_water_quality_comprehensive.html">analyze_water_quality_comprehensive</a></span><span class="op">(</span></span>
<span>  water_data <span class="op">=</span> <span class="va">sample_water_data</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"turbidity"</span>,</span>
<span>  quality_filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    valid_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,  <span class="co"># Reasonable turbidity range</span></span>
<span>    remove_outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    remove_na <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="integration-with-other-package-functions">Integration with Other Package Functions<a class="anchor" aria-label="anchor" href="#integration-with-other-package-functions"></a>
</h2>
<div class="section level3">
<h3 id="combining-water-indices-with-vegetation-analysis">Combining Water Indices with Vegetation Analysis<a class="anchor" aria-label="anchor" href="#combining-water-indices-with-vegetation-analysis"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate both water and vegetation indices from the same data</span></span>
<span><span class="co"># Assume we have a multi-band satellite image</span></span>
<span><span class="va">red_band</span> <span class="op">&lt;-</span> <span class="va">nir_band</span> <span class="op">*</span> <span class="fl">0.6</span>  <span class="co"># Simulate red band</span></span>
<span></span>
<span><span class="co"># Water detection</span></span>
<span><span class="va">water_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_multiple_water_indices.html">calculate_multiple_water_indices</a></span><span class="op">(</span></span>
<span>  green <span class="op">=</span> <span class="va">green_band</span>,</span>
<span>  nir <span class="op">=</span> <span class="va">nir_band</span>,</span>
<span>  swir1 <span class="op">=</span> <span class="va">swir1_band</span>,</span>
<span>  indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NDWI"</span>, <span class="st">"MNDWI"</span>, <span class="st">"NDMI"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Vegetation analysis</span></span>
<span><span class="va">veg_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_multiple_indices.html">calculate_multiple_indices</a></span><span class="op">(</span></span>
<span>  red <span class="op">=</span> <span class="va">red_band</span>,</span>
<span>  nir <span class="op">=</span> <span class="va">nir_band</span>,</span>
<span>  green <span class="op">=</span> <span class="va">green_band</span>,</span>
<span>  indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NDVI"</span>, <span class="st">"GNDVI"</span>, <span class="st">"DVI"</span><span class="op">)</span>,</span>
<span>  output_stack <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create combined analysis</span></span>
<span><span class="va">combined_stack</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">water_indices</span>, <span class="va">veg_indices</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">combined_stack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NDWI"</span>, <span class="st">"MNDWI"</span>, <span class="st">"NDMI"</span>, <span class="st">"NDVI"</span>, <span class="st">"GNDVI"</span>, <span class="st">"DVI"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="spatial-integration-with-field-data">Spatial Integration with Field Data<a class="anchor" aria-label="anchor" href="#spatial-integration-with-field-data"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract satellite-derived water indices to field monitoring points</span></span>
<span><span class="va">extracted_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/universal_spatial_join.html">universal_spatial_join</a></span><span class="op">(</span></span>
<span>  source_data <span class="op">=</span> <span class="va">sample_water_data</span>,</span>
<span>  target_data <span class="op">=</span> <span class="va">water_indices</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"extract"</span>,</span>
<span>  buffer_distance <span class="op">=</span> <span class="fl">100</span>,  <span class="co"># 100m buffer around each point</span></span>
<span>  summary_function <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check correlations between field measurements and remote sensing</span></span>
<span><span class="va">field_vs_remote</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  field_turbidity <span class="op">=</span> <span class="va">extracted_values</span><span class="op">$</span><span class="va">turbidity</span>,</span>
<span>  remote_ndwi <span class="op">=</span> <span class="va">extracted_values</span><span class="op">$</span><span class="va">extracted_NDWI</span>,</span>
<span>  remote_mndwi <span class="op">=</span> <span class="va">extracted_values</span><span class="op">$</span><span class="va">extracted_MNDWI</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate correlations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">field_vs_remote</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<div class="section level3">
<h3 id="index-selection-guidelines">Index Selection Guidelines<a class="anchor" aria-label="anchor" href="#index-selection-guidelines"></a>
</h3>
<ul>
<li>
<strong>NDWI</strong>: Use for general water body detection,
especially clear water</li>
<li>
<strong>MNDWI</strong>: Better for urban areas and turbid water
detection</li>
<li>
<strong>NDMI</strong>: Focus on vegetation moisture content and
drought monitoring</li>
<li>
<strong>MSI</strong>: Detect plant water stress (lower values =
higher moisture)</li>
</ul>
</div>
<div class="section level3">
<h3 id="threshold-recommendations">Threshold Recommendations<a class="anchor" aria-label="anchor" href="#threshold-recommendations"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Standard water detection thresholds</span></span>
<span><span class="va">standard_thresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  NDWI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>water <span class="op">=</span> <span class="fl">0.3</span>, vegetation <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span>,</span>
<span>  MNDWI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>water <span class="op">=</span> <span class="fl">0.5</span>, built_up <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span>,</span>
<span>  NDMI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>high_moisture <span class="op">=</span> <span class="fl">0.4</span>, low_moisture <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply thresholds to create binary water masks</span></span>
<span><span class="va">water_mask_ndwi</span> <span class="op">&lt;-</span> <span class="va">ndwi</span> <span class="op">&gt;</span> <span class="va">standard_thresholds</span><span class="op">$</span><span class="va">NDWI</span><span class="op">$</span><span class="va">water</span></span>
<span><span class="va">water_mask_mndwi</span> <span class="op">&lt;-</span> <span class="va">mndwi</span> <span class="op">&gt;</span> <span class="va">standard_thresholds</span><span class="op">$</span><span class="va">MNDWI</span><span class="op">$</span><span class="va">water</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="quality-control">Quality Control<a class="anchor" aria-label="anchor" href="#quality-control"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Always mask invalid values and apply reasonable ranges</span></span>
<span><span class="va">quality_controlled_ndwi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_water_index.html">calculate_water_index</a></span><span class="op">(</span></span>
<span>  green <span class="op">=</span> <span class="va">green_band</span>,</span>
<span>  nir <span class="op">=</span> <span class="va">nir_band</span>,</span>
<span>  index_type <span class="op">=</span> <span class="st">"NDWI"</span>,</span>
<span>  clamp_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  mask_invalid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check data coverage</span></span>
<span><span class="va">values_ndwi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">quality_controlled_ndwi</span>, mat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">coverage_percent</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">values_ndwi</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">values_ndwi</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Data coverage:"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">coverage_percent</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette demonstrated:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Water Detection Indices</strong>: NDWI, MNDWI, NDMI
calculation and interpretation</li>
<li>
<strong>Field Data Analysis</strong>: Comprehensive water quality
parameter assessment</li>
<li>
<strong>Threshold Classification</strong>: Application of water
quality standards</li>
<li>
<strong>Temporal Analysis</strong>: Trend detection in water quality
time series</li>
<li>
<strong>Visualization</strong>: Creating effective water quality
maps</li>
<li>
<strong>Integration</strong>: Combining remote sensing and field
data</li>
</ol>
<div class="section level3">
<h3 id="key-functions-used">Key Functions Used<a class="anchor" aria-label="anchor" href="#key-functions-used"></a>
</h3>
<ul>
<li>
<code><a href="../reference/calculate_water_index.html">calculate_water_index()</a></code> - Single water index
calculation</li>
<li>
<code><a href="../reference/calculate_multiple_water_indices.html">calculate_multiple_water_indices()</a></code> - Multiple indices
at once</li>
<li>
<code><a href="../reference/analyze_water_bodies.html">analyze_water_bodies()</a></code> - Comprehensive water body
analysis</li>
<li>
<code><a href="../reference/analyze_water_quality_comprehensive.html">analyze_water_quality_comprehensive()</a></code> - Field data
analysis</li>
<li>
<code><a href="../reference/list_water_indices.html">list_water_indices()</a></code> - Available indices
information</li>
<li>
<code><a href="../reference/universal_spatial_join.html">universal_spatial_join()</a></code> - Spatial data
integration</li>
<li>
<code><a href="../reference/create_spatial_map.html">create_spatial_map()</a></code> and <code><a href="../reference/quick_map.html">quick_map()</a></code> -
Visualization</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p>This work was developed by the geospatialsuite team with
contributions from: Olatunde D. Akanbi, Vibha Mandayam, Yinghui Wu,
Jeffrey Yarus, Erika I. Barcelos, and Roger H. French.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>geospatialsuite is developed by the <a href="https://engineering.case.edu/centers/sdle" class="external-link">SDLE Research Center</a> at Case Western Reserve University, supported by NSF CASFER (Award 2133576).</p>
</div>

<div class="pkgdown-footer-right">
  <p>Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a></p>
</div>

    </footer>
</div>





  </body>
</html>
